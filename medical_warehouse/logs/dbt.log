[0m01:49:41.974083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778b2594c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778b257e0110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778b25798190>]}


============================== 01:49:41.991393 | dd381ded-3f20-4111-a7ce-e8db9889f1c5 ==============================
[0m01:49:41.991393 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:49:41.994706 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:49:42.015960 [info ] [MainThread]: dbt version: 1.8.3
[0m01:49:42.018771 [info ] [MainThread]: python version: 3.11.2
[0m01:49:42.021279 [info ] [MainThread]: python path: /usr/local/bin/python
[0m01:49:42.023799 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m01:49:42.388118 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m01:49:42.393938 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m01:49:42.399020 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m01:49:42.405399 [info ] [MainThread]: adapter type: postgres
[0m01:49:42.410778 [info ] [MainThread]: adapter version: 1.8.2
[0m01:49:42.793138 [info ] [MainThread]: Configuration:
[0m01:49:42.800008 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:49:42.808995 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:49:42.815464 [info ] [MainThread]: Required dependencies:
[0m01:49:42.820530 [debug] [MainThread]: Executing "git --help"
[0m01:49:42.835230 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:49:42.840852 [debug] [MainThread]: STDERR: "b''"
[0m01:49:42.845513 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:49:42.853142 [info ] [MainThread]: Connection:
[0m01:49:42.860204 [info ] [MainThread]:   host: host.docker.internal
[0m01:49:42.865021 [info ] [MainThread]:   port: 5432
[0m01:49:42.870148 [info ] [MainThread]:   user: postgres
[0m01:49:42.878516 [info ] [MainThread]:   database: medical_db
[0m01:49:42.885649 [info ] [MainThread]:   schema: raw
[0m01:49:42.891616 [info ] [MainThread]:   connect_timeout: 10
[0m01:49:42.897446 [info ] [MainThread]:   role: None
[0m01:49:42.904763 [info ] [MainThread]:   search_path: None
[0m01:49:42.911631 [info ] [MainThread]:   keepalives_idle: 0
[0m01:49:42.918571 [info ] [MainThread]:   sslmode: None
[0m01:49:42.922467 [info ] [MainThread]:   sslcert: None
[0m01:49:42.927488 [info ] [MainThread]:   sslkey: None
[0m01:49:42.930946 [info ] [MainThread]:   sslrootcert: None
[0m01:49:42.933740 [info ] [MainThread]:   application_name: dbt
[0m01:49:42.936782 [info ] [MainThread]:   retries: 1
[0m01:49:42.940258 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:49:42.950032 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m01:49:43.047088 [debug] [MainThread]: Using postgres connection "debug"
[0m01:49:43.049139 [debug] [MainThread]: On debug: select 1 as id
[0m01:49:43.051004 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:49:43.215280 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m01:49:43.219097 [debug] [MainThread]: On debug: Close
[0m01:49:43.221947 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:49:43.225045 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:49:43.230202 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.4063139, "process_user_time": 4.390988, "process_kernel_time": 0.7647, "process_mem_max_rss": "105540", "process_in_blocks": "392", "process_out_blocks": "1152"}
[0m01:49:43.233166 [debug] [MainThread]: Command `dbt debug` succeeded at 01:49:43.232902 after 1.41 seconds
[0m01:49:43.235665 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:49:43.238139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778b26478ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778b2594c1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778b23ac9ad0>]}
[0m01:49:43.241077 [debug] [MainThread]: Flushing usage events
[0m01:50:03.886343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9172b45210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9172dbc6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9172b44f90>]}


============================== 01:50:03.904003 | af16b88e-2ef3-4283-b421-16a03839c51f ==============================
[0m01:50:03.904003 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:50:03.908101 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m01:50:03.933741 [info ] [MainThread]: dbt version: 1.8.3
[0m01:50:03.936699 [info ] [MainThread]: python version: 3.11.2
[0m01:50:03.939710 [info ] [MainThread]: python path: /usr/local/bin/python
[0m01:50:03.942342 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m01:50:03.953870 [error] [MainThread]: Encountered an error:
Runtime Error
  Syntax error near line 7
  ------------------------------
  4  |       type: postgres
  5  |       threads: 1
  6  |       host: "{{ env_var('DB_HOST', 'localhost') }}"
  7  |       port: {{ env_var('DB_PORT', 5432) | int }}
  8  |       user: "{{ env_var('DB_USER', 'postgres') }}"
  9  |       pass: "{{ env_var('DB_PASSWORD', 'postgres') }}"
  10 |       dbname: "{{ env_var('DB_NAME', 'medical_db') }}"
  
  Raw Error:
  ------------------------------
  while constructing a mapping
    in "<unicode string>", line 7, column 13
  found unhashable key
    in "<unicode string>", line 7, column 14
[0m01:50:03.957996 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.14082399, "process_user_time": 3.586123, "process_kernel_time": 0.661242, "process_mem_max_rss": "93184", "process_out_blocks": "1128", "command_success": false, "process_in_blocks": "0"}
[0m01:50:03.961420 [debug] [MainThread]: Command `dbt debug` failed at 01:50:03.961082 after 0.14 seconds
[0m01:50:03.964002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9172b39550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9176a80bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9176a80cd0>]}
[0m01:50:03.967664 [debug] [MainThread]: Flushing usage events
[0m01:50:29.458753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747b3a52a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747b3a37f090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747b3a6dc090>]}


============================== 01:50:29.478058 | 87ae1e6e-78ce-4d25-89ac-2f6ad0c4300f ==============================
[0m01:50:29.478058 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:50:29.481844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m01:50:29.512017 [info ] [MainThread]: dbt version: 1.8.3
[0m01:50:29.515618 [info ] [MainThread]: python version: 3.11.2
[0m01:50:29.519126 [info ] [MainThread]: python path: /usr/local/bin/python
[0m01:50:29.523988 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m01:50:29.820883 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m01:50:29.824511 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m01:50:29.827886 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m01:50:29.831800 [info ] [MainThread]: adapter type: postgres
[0m01:50:29.835398 [info ] [MainThread]: adapter version: 1.8.2
[0m01:50:30.088322 [info ] [MainThread]: Configuration:
[0m01:50:30.091728 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:50:30.095159 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:50:30.098630 [info ] [MainThread]: Required dependencies:
[0m01:50:30.102565 [debug] [MainThread]: Executing "git --help"
[0m01:50:30.112138 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:50:30.115290 [debug] [MainThread]: STDERR: "b''"
[0m01:50:30.118397 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:50:30.122064 [info ] [MainThread]: Connection:
[0m01:50:30.126704 [info ] [MainThread]:   host: host.docker.internal
[0m01:50:30.131198 [info ] [MainThread]:   port: 5432
[0m01:50:30.136292 [info ] [MainThread]:   user: postgres
[0m01:50:30.140170 [info ] [MainThread]:   database: medical_db
[0m01:50:30.144241 [info ] [MainThread]:   schema: raw
[0m01:50:30.147485 [info ] [MainThread]:   connect_timeout: 10
[0m01:50:30.151122 [info ] [MainThread]:   role: None
[0m01:50:30.155550 [info ] [MainThread]:   search_path: None
[0m01:50:30.159178 [info ] [MainThread]:   keepalives_idle: 0
[0m01:50:30.162739 [info ] [MainThread]:   sslmode: None
[0m01:50:30.167619 [info ] [MainThread]:   sslcert: None
[0m01:50:30.172000 [info ] [MainThread]:   sslkey: None
[0m01:50:30.175578 [info ] [MainThread]:   sslrootcert: None
[0m01:50:30.178769 [info ] [MainThread]:   application_name: dbt
[0m01:50:30.182406 [info ] [MainThread]:   retries: 1
[0m01:50:30.186471 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:50:30.198388 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m01:50:30.312546 [debug] [MainThread]: Using postgres connection "debug"
[0m01:50:30.315063 [debug] [MainThread]: On debug: select 1 as id
[0m01:50:30.319120 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:50:30.460793 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m01:50:30.466249 [debug] [MainThread]: On debug: Close
[0m01:50:30.469994 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:50:30.476640 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:50:30.483995 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.2059848, "process_user_time": 4.13944, "process_kernel_time": 0.71134, "process_mem_max_rss": "105512", "process_out_blocks": "1152", "process_in_blocks": "0"}
[0m01:50:30.489030 [debug] [MainThread]: Command `dbt debug` succeeded at 01:50:30.488361 after 1.21 seconds
[0m01:50:30.492983 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:50:30.496231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747b3a55b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747b3e314610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747b3e470250>]}
[0m01:50:30.499580 [debug] [MainThread]: Flushing usage events
[0m01:51:13.558760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782267cd32d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782267cd2c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782267cd2a50>]}


============================== 01:51:13.579148 | 642e7c28-89bf-4ab5-8dd4-8cac7305c269 ==============================
[0m01:51:13.579148 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:51:13.583411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select staging', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:51:14.274603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '642e7c28-89bf-4ab5-8dd4-8cac7305c269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782267b59390>]}
[0m01:51:14.554719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '642e7c28-89bf-4ab5-8dd4-8cac7305c269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7822698b1a90>]}
[0m01:51:14.558292 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:51:14.593788 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:51:14.604082 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:51:14.606962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '642e7c28-89bf-4ab5-8dd4-8cac7305c269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782267d21690>]}
[0m01:51:17.535073 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:51:17.538940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '642e7c28-89bf-4ab5-8dd4-8cac7305c269', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78226631e650>]}
[0m01:51:18.388150 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.medical_warehouse.marts
[0m01:51:18.431796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '642e7c28-89bf-4ab5-8dd4-8cac7305c269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7822660f1190>]}
[0m01:51:18.978485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '642e7c28-89bf-4ab5-8dd4-8cac7305c269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782266442250>]}
[0m01:51:18.987902 [info ] [MainThread]: Found 1 model, 3 data tests, 1 source, 415 macros
[0m01:51:18.998839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '642e7c28-89bf-4ab5-8dd4-8cac7305c269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782266432710>]}
[0m01:51:19.007380 [info ] [MainThread]: 
[0m01:51:19.012491 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:51:19.017646 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_db'
[0m01:51:19.138704 [debug] [ThreadPool]: Using postgres connection "list_medical_db"
[0m01:51:19.141144 [debug] [ThreadPool]: On list_medical_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_db"} */

    select distinct nspname from pg_namespace
  
[0m01:51:19.143615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:51:19.498493 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m01:51:19.507181 [debug] [ThreadPool]: On list_medical_db: Close
[0m01:51:19.517739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_db, now list_medical_db_raw)
[0m01:51:19.549666 [debug] [ThreadPool]: Using postgres connection "list_medical_db_raw"
[0m01:51:19.554869 [debug] [ThreadPool]: On list_medical_db_raw: BEGIN
[0m01:51:19.559670 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:51:19.831400 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:51:19.836976 [debug] [ThreadPool]: Using postgres connection "list_medical_db_raw"
[0m01:51:19.840157 [debug] [ThreadPool]: On list_medical_db_raw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_db_raw"} */
select
      'medical_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'medical_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'medical_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m01:51:19.972510 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m01:51:19.978421 [debug] [ThreadPool]: On list_medical_db_raw: ROLLBACK
[0m01:51:19.986373 [debug] [ThreadPool]: On list_medical_db_raw: Close
[0m01:51:20.000024 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:20.002994 [debug] [MainThread]: On master: BEGIN
[0m01:51:20.005338 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:51:20.135170 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:51:20.137569 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:20.142498 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:51:20.181249 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m01:51:20.186830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '642e7c28-89bf-4ab5-8dd4-8cac7305c269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7822664422d0>]}
[0m01:51:20.189593 [debug] [MainThread]: On master: ROLLBACK
[0m01:51:20.197519 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:20.200262 [debug] [MainThread]: On master: BEGIN
[0m01:51:20.206610 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:51:20.209869 [debug] [MainThread]: On master: COMMIT
[0m01:51:20.213757 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:20.217050 [debug] [MainThread]: On master: COMMIT
[0m01:51:20.223507 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:51:20.229692 [debug] [MainThread]: On master: Close
[0m01:51:20.233048 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:51:20.236380 [info ] [MainThread]: 
[0m01:51:20.263747 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m01:51:20.267053 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.stg_telegram_messages .......................... [RUN]
[0m01:51:20.270414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medical_db_raw, now model.medical_warehouse.stg_telegram_messages)
[0m01:51:20.273143 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m01:51:20.296709 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m01:51:20.352146 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m01:51:20.480777 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m01:51:20.530050 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m01:51:20.532983 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: BEGIN
[0m01:51:20.535361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:20.653456 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:51:20.656128 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m01:51:20.659404 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "medical_db"."raw"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    with source as (
    select * from "medical_db"."raw"."telegram_messages"
),

renamed as (
    select
        id as environment_id,
        message_id,
        channel_name,
        message_date::timestamp as message_date,
        message_text,
        price,
        has_media,
        image_path,
        views as view_count,
        forwards as forward_count,
        length(message_text) as message_length,
        created_at
    from source
    where message_id is not null
)

select * from renamed
  );
[0m01:51:20.709429 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "price" does not exist
LINE 18:         price,
                 ^

[0m01:51:20.713935 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: ROLLBACK
[0m01:51:20.719972 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m01:51:20.734659 [debug] [Thread-1 (]: Database Error in model stg_telegram_messages (models/staging/stg_telegram_messages.sql)
  column "price" does not exist
  LINE 18:         price,
                   ^
  compiled Code at target/run/medical_warehouse/models/staging/stg_telegram_messages.sql
[0m01:51:20.740385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '642e7c28-89bf-4ab5-8dd4-8cac7305c269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782266348b10>]}
[0m01:51:20.745966 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw.stg_telegram_messages ................. [[31mERROR[0m in 0.47s]
[0m01:51:20.751059 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m01:51:20.762613 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:20.765468 [debug] [MainThread]: On master: BEGIN
[0m01:51:20.768309 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:51:21.077169 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:51:21.083086 [debug] [MainThread]: On master: COMMIT
[0m01:51:21.087931 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:21.094437 [debug] [MainThread]: On master: COMMIT
[0m01:51:21.105036 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:51:21.110978 [debug] [MainThread]: On master: Close
[0m01:51:21.118536 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:51:21.124018 [debug] [MainThread]: Connection 'model.medical_warehouse.stg_telegram_messages' was properly closed.
[0m01:51:21.131291 [info ] [MainThread]: 
[0m01:51:21.136299 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m01:51:21.145659 [debug] [MainThread]: Command end result
[0m01:51:21.403975 [info ] [MainThread]: 
[0m01:51:21.414824 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:51:21.426540 [info ] [MainThread]: 
[0m01:51:21.435669 [error] [MainThread]:   Database Error in model stg_telegram_messages (models/staging/stg_telegram_messages.sql)
  column "price" does not exist
  LINE 18:         price,
                   ^
  compiled Code at target/run/medical_warehouse/models/staging/stg_telegram_messages.sql
[0m01:51:21.445371 [info ] [MainThread]: 
[0m01:51:21.453385 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:51:21.467847 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.081939, "process_user_time": 8.696579, "process_kernel_time": 0.857922, "process_mem_max_rss": "115800", "process_out_blocks": "1272", "command_success": false, "process_in_blocks": "0"}
[0m01:51:21.472098 [debug] [MainThread]: Command `dbt run` failed at 01:51:21.471545 after 8.09 seconds
[0m01:51:21.476620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782267e90310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782267cd29d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78226baa44d0>]}
[0m01:51:21.479211 [debug] [MainThread]: Flushing usage events
[0m01:51:44.765324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b11f543b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b11f5633c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b11f54fc250>]}


============================== 01:51:44.786598 | ae904ac0-1fb2-4c70-8ed5-f18ddcaf662f ==============================
[0m01:51:44.786598 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:51:44.790158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:51:45.243480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae904ac0-1fb2-4c70-8ed5-f18ddcaf662f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b11f548b910>]}
[0m01:51:45.392048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae904ac0-1fb2-4c70-8ed5-f18ddcaf662f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b11f704d490>]}
[0m01:51:45.395847 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:51:45.428102 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:51:46.039245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:51:46.042834 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models/staging/stg_telegram_messages.sql
[0m01:51:46.595618 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:51:46.598910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ae904ac0-1fb2-4c70-8ed5-f18ddcaf662f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b11f3bafad0>]}
[0m01:51:46.979578 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.medical_warehouse.marts
[0m01:51:47.011007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae904ac0-1fb2-4c70-8ed5-f18ddcaf662f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b11f271d750>]}
[0m01:51:47.307592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae904ac0-1fb2-4c70-8ed5-f18ddcaf662f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b11f2695910>]}
[0m01:51:47.310816 [info ] [MainThread]: Found 1 model, 3 data tests, 1 source, 415 macros
[0m01:51:47.313914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae904ac0-1fb2-4c70-8ed5-f18ddcaf662f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b11f3bcab10>]}
[0m01:51:47.322148 [info ] [MainThread]: 
[0m01:51:47.326846 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:51:47.332129 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_db'
[0m01:51:47.447189 [debug] [ThreadPool]: Using postgres connection "list_medical_db"
[0m01:51:47.451813 [debug] [ThreadPool]: On list_medical_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_db"} */

    select distinct nspname from pg_namespace
  
[0m01:51:47.454693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:51:47.589464 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m01:51:47.594626 [debug] [ThreadPool]: On list_medical_db: Close
[0m01:51:47.601158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_db, now list_medical_db_raw)
[0m01:51:47.620283 [debug] [ThreadPool]: Using postgres connection "list_medical_db_raw"
[0m01:51:47.623704 [debug] [ThreadPool]: On list_medical_db_raw: BEGIN
[0m01:51:47.626384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:51:47.777657 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:51:47.781120 [debug] [ThreadPool]: Using postgres connection "list_medical_db_raw"
[0m01:51:47.784891 [debug] [ThreadPool]: On list_medical_db_raw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_db_raw"} */
select
      'medical_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'medical_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'medical_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m01:51:47.814656 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m01:51:47.821453 [debug] [ThreadPool]: On list_medical_db_raw: ROLLBACK
[0m01:51:47.829620 [debug] [ThreadPool]: On list_medical_db_raw: Close
[0m01:51:47.863149 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:47.868637 [debug] [MainThread]: On master: BEGIN
[0m01:51:47.873446 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:51:48.090665 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:51:48.095779 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:48.101607 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:51:48.154618 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m01:51:48.162601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae904ac0-1fb2-4c70-8ed5-f18ddcaf662f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b11f26e4910>]}
[0m01:51:48.168711 [debug] [MainThread]: On master: ROLLBACK
[0m01:51:48.179649 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:48.185505 [debug] [MainThread]: On master: BEGIN
[0m01:51:48.199707 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:51:48.205606 [debug] [MainThread]: On master: COMMIT
[0m01:51:48.210644 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:48.215636 [debug] [MainThread]: On master: COMMIT
[0m01:51:48.224975 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:51:48.229767 [debug] [MainThread]: On master: Close
[0m01:51:48.236177 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:51:48.242410 [info ] [MainThread]: 
[0m01:51:48.297107 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m01:51:48.335508 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.stg_telegram_messages .......................... [RUN]
[0m01:51:48.343568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medical_db_raw, now model.medical_warehouse.stg_telegram_messages)
[0m01:51:48.350172 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m01:51:48.395041 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m01:51:48.451414 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m01:51:48.651148 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m01:51:48.673863 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m01:51:48.677183 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: BEGIN
[0m01:51:48.680157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:48.823635 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:51:48.825969 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m01:51:48.828226 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "medical_db"."raw"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    with source as (
    select * from "medical_db"."raw"."telegram_messages"
),

renamed as (
    select
        id as environment_id,
        message_id,
        channel_name,
        message_date::timestamp as message_date,
        message_text,
        has_media,
        image_path,
        views as view_count,
        forwards as forward_count,
        length(message_text) as message_length,
        created_at
    from source
    where message_id is not null
)

select * from renamed
  );
[0m01:51:48.891934 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:51:48.907264 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m01:51:48.909583 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "medical_db"."raw"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m01:51:48.916252 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:51:48.948443 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m01:51:48.952441 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m01:51:48.954930 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m01:51:48.961019 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m01:51:48.982609 [debug] [Thread-1 (]: Applying DROP to: "medical_db"."raw"."stg_telegram_messages__dbt_backup"
[0m01:51:49.004012 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m01:51:49.007039 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
drop view if exists "medical_db"."raw"."stg_telegram_messages__dbt_backup" cascade
[0m01:51:49.013776 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m01:51:49.023858 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m01:51:49.030353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae904ac0-1fb2-4c70-8ed5-f18ddcaf662f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b11f26d5810>]}
[0m01:51:49.035783 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw.stg_telegram_messages ..................... [[32mCREATE VIEW[0m in 0.69s]
[0m01:51:49.042394 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m01:51:49.049605 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:49.053284 [debug] [MainThread]: On master: BEGIN
[0m01:51:49.055934 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:51:49.194462 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:51:49.197647 [debug] [MainThread]: On master: COMMIT
[0m01:51:49.201389 [debug] [MainThread]: Using postgres connection "master"
[0m01:51:49.205560 [debug] [MainThread]: On master: COMMIT
[0m01:51:49.211255 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:51:49.214491 [debug] [MainThread]: On master: Close
[0m01:51:49.219613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:51:49.223022 [debug] [MainThread]: Connection 'model.medical_warehouse.stg_telegram_messages' was properly closed.
[0m01:51:49.226223 [info ] [MainThread]: 
[0m01:51:49.229257 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.90 seconds (1.90s).
[0m01:51:49.235503 [debug] [MainThread]: Command end result
[0m01:51:49.658269 [info ] [MainThread]: 
[0m01:51:49.690747 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:51:49.693320 [info ] [MainThread]: 
[0m01:51:49.695970 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:51:49.701342 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.0962405, "process_user_time": 6.195607, "process_kernel_time": 0.727484, "process_mem_max_rss": "117504", "process_out_blocks": "1272", "process_in_blocks": "0"}
[0m01:51:49.704275 [debug] [MainThread]: Command `dbt run` succeeded at 01:51:49.703953 after 5.10 seconds
[0m01:51:49.706748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b11f586fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b11f923c790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b11f93c0350>]}
[0m01:51:49.709448 [debug] [MainThread]: Flushing usage events
[0m01:52:25.776717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c14d04b6d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c14d04b6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c14d04b6ad0>]}


============================== 01:52:25.794360 | c9d5af32-1cad-4798-87d8-2b55cc6a1a59 ==============================
[0m01:52:25.794360 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:52:25.797619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:52:26.099358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9d5af32-1cad-4798-87d8-2b55cc6a1a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c14d038bed0>]}
[0m01:52:26.137594 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3ceetbdq'
[0m01:52:26.140996 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:52:27.067227 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:52:27.075863 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:52:27.547739 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:52:27.679413 [info ] [MainThread]: Updating lock file in file path: /usr/app/dbt/package-lock.yml
[0m01:52:27.752202 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-bibm2ecc'
[0m01:52:27.782543 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:52:44.959297 [info ] [MainThread]: Installed from version 1.1.1
[0m01:52:44.993684 [info ] [MainThread]: Updated version available: 1.3.3
[0m01:52:45.014650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c9d5af32-1cad-4798-87d8-2b55cc6a1a59', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c14d0524c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c14d03c9110>]}
[0m01:52:45.032299 [info ] [MainThread]: 
[0m01:52:45.042265 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m01:52:45.099305 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 19.506804, "process_user_time": 4.165696, "process_kernel_time": 1.616539, "process_mem_max_rss": "95216", "process_out_blocks": "1328", "process_in_blocks": "0"}
[0m01:52:45.121109 [debug] [MainThread]: Command `dbt deps` succeeded at 01:52:45.120620 after 19.53 seconds
[0m01:52:45.145048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c14d068c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c14d068c210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c14d43006d0>]}
[0m01:52:45.152687 [debug] [MainThread]: Flushing usage events
[0m01:53:13.137729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eccd0dff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eccd2dbb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eccd12e150>]}


============================== 01:53:13.155551 | dc634161-c919-442b-9b1f-39231d2cbabf ==============================
[0m01:53:13.155551 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:53:13.158385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:53:13.692018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc634161-c919-442b-9b1f-39231d2cbabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eccd165e90>]}
[0m01:53:13.935673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc634161-c919-442b-9b1f-39231d2cbabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ecced059d0>]}
[0m01:53:13.942073 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:53:14.110342 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:53:14.461710 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m01:53:14.466603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dc634161-c919-442b-9b1f-39231d2cbabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ecce5db390>]}
[0m01:53:23.960671 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:53:23.963831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dc634161-c919-442b-9b1f-39231d2cbabf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eccf62cc10>]}
[0m01:53:24.646769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc634161-c919-442b-9b1f-39231d2cbabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ecca426010>]}
[0m01:53:25.011162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc634161-c919-442b-9b1f-39231d2cbabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eccb744210>]}
[0m01:53:25.015584 [info ] [MainThread]: Found 4 models, 10 data tests, 1 source, 529 macros
[0m01:53:25.020298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc634161-c919-442b-9b1f-39231d2cbabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ecca406150>]}
[0m01:53:25.030516 [info ] [MainThread]: 
[0m01:53:25.035063 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:53:25.050183 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_db'
[0m01:53:25.148598 [debug] [ThreadPool]: Using postgres connection "list_medical_db"
[0m01:53:25.151977 [debug] [ThreadPool]: On list_medical_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_db"} */

    select distinct nspname from pg_namespace
  
[0m01:53:25.154920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:53:25.318201 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m01:53:25.324567 [debug] [ThreadPool]: On list_medical_db: Close
[0m01:53:25.333715 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_db, now list_medical_db_raw)
[0m01:53:25.354685 [debug] [ThreadPool]: Using postgres connection "list_medical_db_raw"
[0m01:53:25.357733 [debug] [ThreadPool]: On list_medical_db_raw: BEGIN
[0m01:53:25.360816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:53:25.483117 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:53:25.485821 [debug] [ThreadPool]: Using postgres connection "list_medical_db_raw"
[0m01:53:25.488555 [debug] [ThreadPool]: On list_medical_db_raw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_db_raw"} */
select
      'medical_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'medical_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'medical_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m01:53:25.509019 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m01:53:25.514053 [debug] [ThreadPool]: On list_medical_db_raw: ROLLBACK
[0m01:53:25.518800 [debug] [ThreadPool]: On list_medical_db_raw: Close
[0m01:53:25.535505 [debug] [MainThread]: Using postgres connection "master"
[0m01:53:25.538582 [debug] [MainThread]: On master: BEGIN
[0m01:53:25.541347 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:53:25.669597 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:53:25.672899 [debug] [MainThread]: Using postgres connection "master"
[0m01:53:25.676073 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:53:25.704250 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m01:53:25.710244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc634161-c919-442b-9b1f-39231d2cbabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ecca1cc790>]}
[0m01:53:25.713511 [debug] [MainThread]: On master: ROLLBACK
[0m01:53:25.719017 [debug] [MainThread]: Using postgres connection "master"
[0m01:53:25.722221 [debug] [MainThread]: On master: BEGIN
[0m01:53:25.729484 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:53:25.732517 [debug] [MainThread]: On master: COMMIT
[0m01:53:25.735452 [debug] [MainThread]: Using postgres connection "master"
[0m01:53:25.738362 [debug] [MainThread]: On master: COMMIT
[0m01:53:25.744394 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:53:25.747576 [debug] [MainThread]: On master: Close
[0m01:53:25.750855 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:53:25.754243 [info ] [MainThread]: 
[0m01:53:25.783825 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_dates
[0m01:53:25.787691 [info ] [Thread-1 (]: 1 of 4 START sql table model raw.dim_dates ..................................... [RUN]
[0m01:53:25.791976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medical_db_raw, now model.medical_warehouse.dim_dates)
[0m01:53:25.795128 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_dates
[0m01:53:25.867183 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m01:53:25.870868 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: BEGIN
[0m01:53:25.874525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:26.046009 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:53:26.049410 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m01:53:26.052612 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */


        select 
        ((cast('2026-01-01' as date))::date - (cast('2024-01-01' as date))::date)
    
[0m01:53:26.095734 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:53:26.101654 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_dates"
[0m01:53:26.139734 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_dates
[0m01:53:26.265509 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.dim_dates"
[0m01:53:26.296719 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m01:53:26.299511 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */

  
    

  create  table "medical_db"."raw"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    with dates as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
    
    

    )

    select *
    from unioned
    where generated_number <= 731
    order by generated_number



),

all_periods as (

    select (
        

    cast('2024-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2026-01-01' as date)

)

select * from filtered


)
select
    date_day,
    extract(year from date_day) as year,
    extract(month from date_day) as month,
    to_char(date_day, 'Month') as month_name,
    extract(day from date_day) as day_of_month,
    to_char(date_day, 'Day') as day_name,
    extract(dow from date_day) as day_of_week,
    extract(quarter from date_day) as quarter
from dates
  );
  
[0m01:53:26.390600 [debug] [Thread-1 (]: SQL status: SELECT 731 in 0.0 seconds
[0m01:53:26.408221 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m01:53:26.410888 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
alter table "medical_db"."raw"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m01:53:26.416174 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:53:26.485233 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m01:53:26.487709 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m01:53:26.489614 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m01:53:26.496502 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m01:53:26.513878 [debug] [Thread-1 (]: Applying DROP to: "medical_db"."raw"."dim_dates__dbt_backup"
[0m01:53:26.529586 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m01:53:26.532721 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
drop table if exists "medical_db"."raw"."dim_dates__dbt_backup" cascade
[0m01:53:26.537914 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m01:53:26.546716 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: Close
[0m01:53:26.553415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc634161-c919-442b-9b1f-39231d2cbabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ecca1cc190>]}
[0m01:53:26.558885 [info ] [Thread-1 (]: 1 of 4 OK created sql table model raw.dim_dates ................................ [[32mSELECT 731[0m in 0.76s]
[0m01:53:26.597186 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_dates
[0m01:53:26.632197 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m01:53:26.657644 [info ] [Thread-1 (]: 2 of 4 START sql view model raw.stg_telegram_messages .......................... [RUN]
[0m01:53:26.683586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_dates, now model.medical_warehouse.stg_telegram_messages)
[0m01:53:26.713554 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m01:53:26.757700 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m01:53:26.840084 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m01:53:26.909526 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m01:53:26.927385 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m01:53:26.929386 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: BEGIN
[0m01:53:26.931221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:27.038524 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:53:27.041264 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m01:53:27.044390 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "medical_db"."raw"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    with source as (
    select * from "medical_db"."raw"."telegram_messages"
),

renamed as (
    select
        id as environment_id,
        message_id,
        channel_name,
        message_date::timestamp as message_date,
        message_text,
        has_media,
        image_path,
        views as view_count,
        forwards as forward_count,
        length(message_text) as message_length,
        created_at
    from source
    where message_id is not null
)

select * from renamed
  );
[0m01:53:27.066727 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:53:27.080371 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m01:53:27.083768 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "medical_db"."raw"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m01:53:27.090299 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:53:27.101094 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m01:53:27.104018 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "medical_db"."raw"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m01:53:27.112290 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:53:27.123764 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m01:53:27.128339 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m01:53:27.131666 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m01:53:27.138890 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m01:53:27.151828 [debug] [Thread-1 (]: Applying DROP to: "medical_db"."raw"."stg_telegram_messages__dbt_backup"
[0m01:53:27.163380 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m01:53:27.166639 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
drop view if exists "medical_db"."raw"."stg_telegram_messages__dbt_backup" cascade
[0m01:53:27.178040 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m01:53:27.184306 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m01:53:27.187883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc634161-c919-442b-9b1f-39231d2cbabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ecc9672dd0>]}
[0m01:53:27.191934 [info ] [Thread-1 (]: 2 of 4 OK created sql view model raw.stg_telegram_messages ..................... [[32mCREATE VIEW[0m in 0.50s]
[0m01:53:27.199914 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m01:53:27.205535 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_channels
[0m01:53:27.209578 [info ] [Thread-1 (]: 3 of 4 START sql table model raw.dim_channels .................................. [RUN]
[0m01:53:27.213561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.stg_telegram_messages, now model.medical_warehouse.dim_channels)
[0m01:53:27.217184 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_channels
[0m01:53:27.233863 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m01:53:27.264343 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_channels
[0m01:53:27.278587 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.dim_channels"
[0m01:53:27.307755 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m01:53:27.311520 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: BEGIN
[0m01:53:27.314589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:27.443983 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:53:27.447711 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m01:53:27.450566 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */

  
    

  create  table "medical_db"."raw"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    with stg as (
    select * from "medical_db"."raw"."stg_telegram_messages"
),

channel_stats as (
    select
        channel_name,
        count(*) as total_posts,
        min(created_at) as first_extracted_at,
        max(created_at) as last_extracted_at,
        avg(view_count) as avg_views
    from stg
    group by 1
)

select 
    md5(cast(coalesce(cast(channel_name as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as channel_key,
    *
from channel_stats
  );
  
[0m01:53:27.515410 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.0 seconds
[0m01:53:27.524143 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m01:53:27.527212 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "medical_db"."raw"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m01:53:27.532973 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:53:27.538675 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m01:53:27.541793 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m01:53:27.545123 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m01:53:27.551165 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m01:53:27.558819 [debug] [Thread-1 (]: Applying DROP to: "medical_db"."raw"."dim_channels__dbt_backup"
[0m01:53:27.562563 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m01:53:27.564924 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
drop table if exists "medical_db"."raw"."dim_channels__dbt_backup" cascade
[0m01:53:27.569891 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m01:53:27.575587 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: Close
[0m01:53:27.579094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc634161-c919-442b-9b1f-39231d2cbabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ecc97df390>]}
[0m01:53:27.582422 [info ] [Thread-1 (]: 3 of 4 OK created sql table model raw.dim_channels ............................. [[32mSELECT 3[0m in 0.37s]
[0m01:53:27.586102 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_channels
[0m01:53:27.590235 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_messages
[0m01:53:27.593392 [info ] [Thread-1 (]: 4 of 4 START sql table model raw.fct_messages .................................. [RUN]
[0m01:53:27.596243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_channels, now model.medical_warehouse.fct_messages)
[0m01:53:27.599197 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fct_messages
[0m01:53:27.608620 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fct_messages"
[0m01:53:27.634401 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fct_messages
[0m01:53:27.645384 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.fct_messages"
[0m01:53:27.669958 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m01:53:27.672666 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: BEGIN
[0m01:53:27.676648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:27.781797 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:53:27.784368 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m01:53:27.787111 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */

  
    

  create  table "medical_db"."raw"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    with stg as (
    select * from "medical_db"."raw"."stg_telegram_messages"
),

dim_channels as (
    select * from "medical_db"."raw"."dim_channels"
)

select
    stg.message_id,
    c.channel_key,
    stg.message_date,
    stg.message_text,
    stg.message_length,
    stg.view_count,
    stg.forward_count,
    stg.has_media,
    stg.image_path
from stg
left join dim_channels c on stg.channel_name = c.channel_name
  );
  
[0m01:53:27.824442 [debug] [Thread-1 (]: SQL status: SELECT 150 in 0.0 seconds
[0m01:53:27.835916 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m01:53:27.839121 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
alter table "medical_db"."raw"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m01:53:27.846741 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:53:27.853020 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: COMMIT
[0m01:53:27.855950 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m01:53:27.859967 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: COMMIT
[0m01:53:27.867231 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m01:53:27.876766 [debug] [Thread-1 (]: Applying DROP to: "medical_db"."raw"."fct_messages__dbt_backup"
[0m01:53:27.881181 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m01:53:27.884502 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
drop table if exists "medical_db"."raw"."fct_messages__dbt_backup" cascade
[0m01:53:27.891725 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m01:53:27.897886 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: Close
[0m01:53:27.901820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc634161-c919-442b-9b1f-39231d2cbabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ecc9612490>]}
[0m01:53:27.905676 [info ] [Thread-1 (]: 4 of 4 OK created sql table model raw.fct_messages ............................. [[32mSELECT 150[0m in 0.31s]
[0m01:53:27.913891 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_messages
[0m01:53:27.921155 [debug] [MainThread]: Using postgres connection "master"
[0m01:53:27.924524 [debug] [MainThread]: On master: BEGIN
[0m01:53:27.928003 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:53:28.062791 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:53:28.065723 [debug] [MainThread]: On master: COMMIT
[0m01:53:28.068414 [debug] [MainThread]: Using postgres connection "master"
[0m01:53:28.071001 [debug] [MainThread]: On master: COMMIT
[0m01:53:28.076800 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:53:28.079606 [debug] [MainThread]: On master: Close
[0m01:53:28.082418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:53:28.085402 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_messages' was properly closed.
[0m01:53:28.088513 [info ] [MainThread]: 
[0m01:53:28.093150 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 3.05 seconds (3.05s).
[0m01:53:28.099260 [debug] [MainThread]: Command end result
[0m01:53:28.282721 [info ] [MainThread]: 
[0m01:53:28.286424 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:53:28.289951 [info ] [MainThread]: 
[0m01:53:28.294291 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:53:28.299212 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.3600855, "process_user_time": 10.153584, "process_kernel_time": 1.20411, "process_mem_max_rss": "119168", "process_out_blocks": "1272", "process_in_blocks": "0"}
[0m01:53:28.303031 [debug] [MainThread]: Command `dbt run` succeeded at 01:53:28.302627 after 15.36 seconds
[0m01:53:28.306640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eccd1a34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ecd0f286d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ecd1084310>]}
[0m01:53:28.310241 [debug] [MainThread]: Flushing usage events
[0m01:53:49.377016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7458a1d34050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7458a1d37710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7458a1d36a90>]}


============================== 01:53:49.396291 | fe8742d7-72e6-4d1a-9143-884529b8db55 ==============================
[0m01:53:49.396291 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:53:49.400414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m01:53:50.061495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe8742d7-72e6-4d1a-9143-884529b8db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7458a1baac10>]}
[0m01:53:50.215057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe8742d7-72e6-4d1a-9143-884529b8db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7458a393d8d0>]}
[0m01:53:50.219261 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:53:50.305254 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:53:56.527414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:53:56.529382 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:53:56.636137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe8742d7-72e6-4d1a-9143-884529b8db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7458a04b0e10>]}
[0m01:53:57.100784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe8742d7-72e6-4d1a-9143-884529b8db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74589ff5de10>]}
[0m01:53:57.104235 [info ] [MainThread]: Found 4 models, 10 data tests, 1 source, 529 macros
[0m01:53:57.107734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe8742d7-72e6-4d1a-9143-884529b8db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7458a04a4dd0>]}
[0m01:53:57.117309 [info ] [MainThread]: 
[0m01:53:57.121153 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:53:57.136213 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_db_raw'
[0m01:53:57.255738 [debug] [ThreadPool]: Using postgres connection "list_medical_db_raw"
[0m01:53:57.259066 [debug] [ThreadPool]: On list_medical_db_raw: BEGIN
[0m01:53:57.262760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:53:57.393701 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:53:57.397011 [debug] [ThreadPool]: Using postgres connection "list_medical_db_raw"
[0m01:53:57.400040 [debug] [ThreadPool]: On list_medical_db_raw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_db_raw"} */
select
      'medical_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'medical_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'medical_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m01:53:57.425005 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m01:53:57.432353 [debug] [ThreadPool]: On list_medical_db_raw: ROLLBACK
[0m01:53:57.437935 [debug] [ThreadPool]: On list_medical_db_raw: Close
[0m01:53:57.463665 [debug] [MainThread]: Using postgres connection "master"
[0m01:53:57.466850 [debug] [MainThread]: On master: BEGIN
[0m01:53:57.470413 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:53:57.598626 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:53:57.601821 [debug] [MainThread]: Using postgres connection "master"
[0m01:53:57.604976 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:53:57.633992 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m01:53:57.639743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe8742d7-72e6-4d1a-9143-884529b8db55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74589ff54dd0>]}
[0m01:53:57.642918 [debug] [MainThread]: On master: ROLLBACK
[0m01:53:57.648393 [debug] [MainThread]: Using postgres connection "master"
[0m01:53:57.651963 [debug] [MainThread]: On master: BEGIN
[0m01:53:57.663639 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:53:57.668998 [debug] [MainThread]: On master: COMMIT
[0m01:53:57.673860 [debug] [MainThread]: Using postgres connection "master"
[0m01:53:57.679791 [debug] [MainThread]: On master: COMMIT
[0m01:53:57.689248 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:53:57.695551 [debug] [MainThread]: On master: Close
[0m01:53:57.701185 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:53:57.708585 [info ] [MainThread]: 
[0m01:53:57.770547 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m01:53:57.776148 [info ] [Thread-1 (]: 1 of 10 START test not_null_dim_channels_channel_key ........................... [RUN]
[0m01:53:57.783265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medical_db_raw, now test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0)
[0m01:53:57.788497 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m01:53:57.876031 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0"
[0m01:53:57.967926 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m01:53:58.065289 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0"
[0m01:53:58.135177 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0"
[0m01:53:58.138778 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0: BEGIN
[0m01:53:58.142780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:58.310876 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:53:58.316937 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0"
[0m01:53:58.322068 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select channel_key
from "medical_db"."raw"."dim_channels"
where channel_key is null



      
    ) dbt_internal_test
[0m01:53:58.337599 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:53:58.358496 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0: ROLLBACK
[0m01:53:58.367977 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0: Close
[0m01:53:58.375407 [info ] [Thread-1 (]: 1 of 10 PASS not_null_dim_channels_channel_key ................................. [[32mPASS[0m in 0.59s]
[0m01:53:58.386999 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m01:53:58.395080 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m01:53:58.401029 [info ] [Thread-1 (]: 2 of 10 START test not_null_dim_channels_channel_name .......................... [RUN]
[0m01:53:58.407525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0, now test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b)
[0m01:53:58.415468 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m01:53:58.445222 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m01:53:58.502809 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m01:53:58.521402 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m01:53:58.579438 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m01:53:58.585490 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b: BEGIN
[0m01:53:58.591262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:58.863834 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:53:58.869299 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m01:53:58.874153 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select channel_name
from "medical_db"."raw"."dim_channels"
where channel_name is null



      
    ) dbt_internal_test
[0m01:53:58.891101 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:53:58.900863 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b: ROLLBACK
[0m01:53:58.909760 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b: Close
[0m01:53:58.916685 [info ] [Thread-1 (]: 2 of 10 PASS not_null_dim_channels_channel_name ................................ [[32mPASS[0m in 0.51s]
[0m01:53:58.924312 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m01:53:58.930667 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8
[0m01:53:58.936124 [info ] [Thread-1 (]: 3 of 10 START test not_null_fct_messages_channel_key ........................... [RUN]
[0m01:53:58.942528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b, now test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8)
[0m01:53:58.948170 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8
[0m01:53:58.970822 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8"
[0m01:53:59.065731 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8
[0m01:53:59.084016 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8"
[0m01:53:59.147290 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8"
[0m01:53:59.153377 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8: BEGIN
[0m01:53:59.159317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:59.360809 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:53:59.363695 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8"
[0m01:53:59.366440 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select channel_key
from "medical_db"."raw"."fct_messages"
where channel_key is null



      
    ) dbt_internal_test
[0m01:53:59.375701 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:53:59.381746 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8: ROLLBACK
[0m01:53:59.387160 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8: Close
[0m01:53:59.391568 [info ] [Thread-1 (]: 3 of 10 PASS not_null_fct_messages_channel_key ................................. [[32mPASS[0m in 0.45s]
[0m01:53:59.397196 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8
[0m01:53:59.400769 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m01:53:59.403713 [info ] [Thread-1 (]: 4 of 10 START test not_null_fct_messages_message_id ............................ [RUN]
[0m01:53:59.406875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8, now test.medical_warehouse.not_null_fct_messages_message_id.de346706b5)
[0m01:53:59.410672 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m01:53:59.424274 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5"
[0m01:53:59.460532 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m01:53:59.469112 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5"
[0m01:53:59.503554 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5"
[0m01:53:59.506893 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_fct_messages_message_id.de346706b5: BEGIN
[0m01:53:59.510803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:59.638384 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:53:59.642265 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5"
[0m01:53:59.645464 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_fct_messages_message_id.de346706b5: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select message_id
from "medical_db"."raw"."fct_messages"
where message_id is null



      
    ) dbt_internal_test
[0m01:53:59.656542 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:53:59.667163 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_fct_messages_message_id.de346706b5: ROLLBACK
[0m01:53:59.677509 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_fct_messages_message_id.de346706b5: Close
[0m01:53:59.683915 [info ] [Thread-1 (]: 4 of 10 PASS not_null_fct_messages_message_id .................................. [[32mPASS[0m in 0.28s]
[0m01:53:59.691796 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m01:53:59.698214 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m01:53:59.703439 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_telegram_messages_channel_name ................. [RUN]
[0m01:53:59.710316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_fct_messages_message_id.de346706b5, now test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8)
[0m01:53:59.715978 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m01:53:59.739637 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m01:53:59.834356 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m01:53:59.851150 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m01:53:59.940186 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m01:53:59.946795 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: BEGIN
[0m01:53:59.952095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:00.118506 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:54:00.121660 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m01:54:00.124392 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select channel_name
from "medical_db"."raw"."stg_telegram_messages"
where channel_name is null



      
    ) dbt_internal_test
[0m01:54:00.134558 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:54:00.140822 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: ROLLBACK
[0m01:54:00.146129 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: Close
[0m01:54:00.149491 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stg_telegram_messages_channel_name ....................... [[32mPASS[0m in 0.44s]
[0m01:54:00.153321 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m01:54:00.156972 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m01:54:00.160004 [info ] [Thread-1 (]: 6 of 10 START test not_null_stg_telegram_messages_message_date ................. [RUN]
[0m01:54:00.163077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8, now test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14)
[0m01:54:00.165864 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m01:54:00.181308 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m01:54:00.267968 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m01:54:00.286797 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m01:54:00.352018 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m01:54:00.358693 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14: BEGIN
[0m01:54:00.364861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:00.555594 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:54:00.559459 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m01:54:00.562608 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select message_date
from "medical_db"."raw"."stg_telegram_messages"
where message_date is null



      
    ) dbt_internal_test
[0m01:54:00.574450 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:54:00.580425 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14: ROLLBACK
[0m01:54:00.586224 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14: Close
[0m01:54:00.590600 [info ] [Thread-1 (]: 6 of 10 PASS not_null_stg_telegram_messages_message_date ....................... [[32mPASS[0m in 0.43s]
[0m01:54:00.595533 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m01:54:00.599643 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m01:54:00.603099 [info ] [Thread-1 (]: 7 of 10 START test not_null_stg_telegram_messages_message_id ................... [RUN]
[0m01:54:00.608937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14, now test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6)
[0m01:54:00.612764 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m01:54:00.629168 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m01:54:00.663315 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m01:54:00.671256 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m01:54:00.699556 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m01:54:00.703068 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6: BEGIN
[0m01:54:00.707086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:00.835864 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:54:00.838923 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m01:54:00.842293 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select message_id
from "medical_db"."raw"."stg_telegram_messages"
where message_id is null



      
    ) dbt_internal_test
[0m01:54:00.851011 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:54:00.856174 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6: ROLLBACK
[0m01:54:00.861495 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6: Close
[0m01:54:00.864751 [info ] [Thread-1 (]: 7 of 10 PASS not_null_stg_telegram_messages_message_id ......................... [[32mPASS[0m in 0.26s]
[0m01:54:00.869165 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m01:54:00.872405 [debug] [Thread-1 (]: Began running node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m01:54:00.875373 [info ] [Thread-1 (]: 8 of 10 START test relationships_fct_messages_channel_key__channel_key__ref_dim_channels_  [RUN]
[0m01:54:00.878352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6, now test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a)
[0m01:54:00.881471 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m01:54:00.902777 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a"
[0m01:54:00.927223 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m01:54:00.934474 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a"
[0m01:54:00.969155 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a"
[0m01:54:00.972960 [debug] [Thread-1 (]: On test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a: BEGIN
[0m01:54:00.976159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:01.111231 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:54:01.114534 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a"
[0m01:54:01.117466 [debug] [Thread-1 (]: On test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select channel_key as from_field
    from "medical_db"."raw"."fct_messages"
    where channel_key is not null
),

parent as (
    select channel_key as to_field
    from "medical_db"."raw"."dim_channels"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:54:01.129370 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:54:01.135353 [debug] [Thread-1 (]: On test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a: ROLLBACK
[0m01:54:01.141501 [debug] [Thread-1 (]: On test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a: Close
[0m01:54:01.146039 [info ] [Thread-1 (]: 8 of 10 PASS relationships_fct_messages_channel_key__channel_key__ref_dim_channels_  [[32mPASS[0m in 0.27s]
[0m01:54:01.151894 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m01:54:01.155558 [debug] [Thread-1 (]: Began running node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m01:54:01.159492 [info ] [Thread-1 (]: 9 of 10 START test unique_dim_channels_channel_key ............................. [RUN]
[0m01:54:01.162967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a, now test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56)
[0m01:54:01.166073 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m01:54:01.186398 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56"
[0m01:54:01.220032 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m01:54:01.229022 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56"
[0m01:54:01.262451 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56"
[0m01:54:01.265704 [debug] [Thread-1 (]: On test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56: BEGIN
[0m01:54:01.268843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:01.405160 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:54:01.408290 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56"
[0m01:54:01.411148 [debug] [Thread-1 (]: On test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    channel_key as unique_field,
    count(*) as n_records

from "medical_db"."raw"."dim_channels"
where channel_key is not null
group by channel_key
having count(*) > 1



      
    ) dbt_internal_test
[0m01:54:01.419474 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:54:01.424780 [debug] [Thread-1 (]: On test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56: ROLLBACK
[0m01:54:01.429778 [debug] [Thread-1 (]: On test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56: Close
[0m01:54:01.433391 [info ] [Thread-1 (]: 9 of 10 PASS unique_dim_channels_channel_key ................................... [[32mPASS[0m in 0.27s]
[0m01:54:01.439932 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m01:54:01.442955 [debug] [Thread-1 (]: Began running node test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8
[0m01:54:01.445606 [info ] [Thread-1 (]: 10 of 10 START test unique_dim_channels_channel_name ........................... [RUN]
[0m01:54:01.448440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56, now test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8)
[0m01:54:01.451230 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8
[0m01:54:01.462762 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8"
[0m01:54:01.489145 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8
[0m01:54:01.497539 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8"
[0m01:54:01.525353 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8"
[0m01:54:01.528049 [debug] [Thread-1 (]: On test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8: BEGIN
[0m01:54:01.530546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:01.758066 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:54:01.803370 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8"
[0m01:54:01.814003 [debug] [Thread-1 (]: On test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    channel_name as unique_field,
    count(*) as n_records

from "medical_db"."raw"."dim_channels"
where channel_name is not null
group by channel_name
having count(*) > 1



      
    ) dbt_internal_test
[0m01:54:01.823580 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:54:01.828291 [debug] [Thread-1 (]: On test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8: ROLLBACK
[0m01:54:01.833532 [debug] [Thread-1 (]: On test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8: Close
[0m01:54:01.837695 [info ] [Thread-1 (]: 10 of 10 PASS unique_dim_channels_channel_name ................................. [[32mPASS[0m in 0.39s]
[0m01:54:01.843215 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8
[0m01:54:01.861106 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:01.886292 [debug] [MainThread]: On master: BEGIN
[0m01:54:01.921352 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:54:02.048948 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:54:02.052275 [debug] [MainThread]: On master: COMMIT
[0m01:54:02.055860 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:02.059708 [debug] [MainThread]: On master: COMMIT
[0m01:54:02.065526 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:54:02.068858 [debug] [MainThread]: On master: Close
[0m01:54:02.072972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:54:02.076897 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8' was properly closed.
[0m01:54:02.080013 [info ] [MainThread]: 
[0m01:54:02.083300 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 4.96 seconds (4.96s).
[0m01:54:02.093471 [debug] [MainThread]: Command end result
[0m01:54:02.374116 [info ] [MainThread]: 
[0m01:54:02.377596 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:54:02.381225 [info ] [MainThread]: 
[0m01:54:02.385247 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m01:54:02.390995 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 13.219513, "process_user_time": 5.932585, "process_kernel_time": 1.145883, "process_mem_max_rss": "115564", "process_out_blocks": "1272", "process_in_blocks": "0"}
[0m01:54:02.394761 [debug] [MainThread]: Command `dbt test` succeeded at 01:54:02.394357 after 13.22 seconds
[0m01:54:02.398021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7458a5b50690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7458a0444590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7458a5cac250>]}
[0m01:54:02.401049 [debug] [MainThread]: Flushing usage events
[0m01:54:28.805739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762f2bd73a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762f2bdc6fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762f2bdc56d0>]}


============================== 01:54:28.824621 | d2e7fd7b-b01e-40b0-84d1-b93e32d5d549 ==============================
[0m01:54:28.824621 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:54:28.828933 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m01:54:29.448434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2e7fd7b-b01e-40b0-84d1-b93e32d5d549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762f2bdc5f10>]}
[0m01:54:29.661589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2e7fd7b-b01e-40b0-84d1-b93e32d5d549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762f2d979610>]}
[0m01:54:29.667400 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:54:29.807045 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:54:35.120952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m01:54:35.124303 [debug] [MainThread]: Partial parsing: added file: medical_warehouse://tests/assert_no_future_messages.sql
[0m01:54:35.127101 [debug] [MainThread]: Partial parsing: added file: medical_warehouse://tests/assert_positive_views.sql
[0m01:54:35.684905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2e7fd7b-b01e-40b0-84d1-b93e32d5d549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762f2a20ebd0>]}
[0m01:54:36.168763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2e7fd7b-b01e-40b0-84d1-b93e32d5d549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762f2a1fddd0>]}
[0m01:54:36.172362 [info ] [MainThread]: Found 4 models, 12 data tests, 1 source, 529 macros
[0m01:54:36.175330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2e7fd7b-b01e-40b0-84d1-b93e32d5d549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762f29ea6910>]}
[0m01:54:36.183772 [info ] [MainThread]: 
[0m01:54:36.189858 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:54:36.202320 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_db_raw'
[0m01:54:36.303574 [debug] [ThreadPool]: Using postgres connection "list_medical_db_raw"
[0m01:54:36.306164 [debug] [ThreadPool]: On list_medical_db_raw: BEGIN
[0m01:54:36.308674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:54:36.423596 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:54:36.425874 [debug] [ThreadPool]: Using postgres connection "list_medical_db_raw"
[0m01:54:36.428293 [debug] [ThreadPool]: On list_medical_db_raw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_db_raw"} */
select
      'medical_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'medical_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'medical_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m01:54:36.449407 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m01:54:36.455286 [debug] [ThreadPool]: On list_medical_db_raw: ROLLBACK
[0m01:54:36.459927 [debug] [ThreadPool]: On list_medical_db_raw: Close
[0m01:54:36.475662 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:36.478417 [debug] [MainThread]: On master: BEGIN
[0m01:54:36.481026 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:54:36.591345 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:54:36.594467 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:36.597401 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:54:36.627385 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m01:54:36.633277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2e7fd7b-b01e-40b0-84d1-b93e32d5d549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762f2a46b050>]}
[0m01:54:36.636415 [debug] [MainThread]: On master: ROLLBACK
[0m01:54:36.641899 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:36.644784 [debug] [MainThread]: On master: BEGIN
[0m01:54:36.653157 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:54:36.656659 [debug] [MainThread]: On master: COMMIT
[0m01:54:36.659629 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:36.662627 [debug] [MainThread]: On master: COMMIT
[0m01:54:36.668865 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:54:36.672529 [debug] [MainThread]: On master: Close
[0m01:54:36.676353 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:54:36.680003 [info ] [MainThread]: 
[0m01:54:36.712519 [debug] [Thread-1 (]: Began running node test.medical_warehouse.assert_no_future_messages
[0m01:54:36.715675 [info ] [Thread-1 (]: 1 of 12 START test assert_no_future_messages ................................... [RUN]
[0m01:54:36.720591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medical_db_raw, now test.medical_warehouse.assert_no_future_messages)
[0m01:54:36.723859 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.assert_no_future_messages
[0m01:54:36.747228 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.assert_no_future_messages"
[0m01:54:36.787843 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.assert_no_future_messages
[0m01:54:36.839858 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.assert_no_future_messages"
[0m01:54:36.880622 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.assert_no_future_messages"
[0m01:54:36.883838 [debug] [Thread-1 (]: On test.medical_warehouse.assert_no_future_messages: BEGIN
[0m01:54:36.887007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:37.023464 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:54:37.026941 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.assert_no_future_messages"
[0m01:54:37.030132 [debug] [Thread-1 (]: On test.medical_warehouse.assert_no_future_messages: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.assert_no_future_messages"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- data_tests/assert_no_future_messages.sql
-- This test returns records where the message_date is in the future.
-- If the query returns 0 rows, the test passes.

select *
from "medical_db"."raw"."stg_telegram_messages"
where message_date > current_timestamp
      
    ) dbt_internal_test
[0m01:54:37.044057 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:54:37.057397 [debug] [Thread-1 (]: On test.medical_warehouse.assert_no_future_messages: ROLLBACK
[0m01:54:37.063087 [debug] [Thread-1 (]: On test.medical_warehouse.assert_no_future_messages: Close
[0m01:54:37.068332 [info ] [Thread-1 (]: 1 of 12 PASS assert_no_future_messages ......................................... [[32mPASS[0m in 0.35s]
[0m01:54:37.074280 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.assert_no_future_messages
[0m01:54:37.077562 [debug] [Thread-1 (]: Began running node test.medical_warehouse.assert_positive_views
[0m01:54:37.080476 [info ] [Thread-1 (]: 2 of 12 START test assert_positive_views ....................................... [RUN]
[0m01:54:37.083998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.assert_no_future_messages, now test.medical_warehouse.assert_positive_views)
[0m01:54:37.088862 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.assert_positive_views
[0m01:54:37.098040 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.assert_positive_views"
[0m01:54:37.126531 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.assert_positive_views
[0m01:54:37.135784 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.assert_positive_views"
[0m01:54:37.163334 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.assert_positive_views"
[0m01:54:37.166845 [debug] [Thread-1 (]: On test.medical_warehouse.assert_positive_views: BEGIN
[0m01:54:37.170749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:37.298864 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:54:37.302359 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.assert_positive_views"
[0m01:54:37.305373 [debug] [Thread-1 (]: On test.medical_warehouse.assert_positive_views: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.assert_positive_views"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- data_tests/assert_positive_views.sql
-- This test returns records where view_count is negative.
-- If the query returns 0 rows, the test passes.

select *
from "medical_db"."raw"."stg_telegram_messages"
where view_count < 0
      
    ) dbt_internal_test
[0m01:54:37.318644 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:54:37.324870 [debug] [Thread-1 (]: On test.medical_warehouse.assert_positive_views: ROLLBACK
[0m01:54:37.330519 [debug] [Thread-1 (]: On test.medical_warehouse.assert_positive_views: Close
[0m01:54:37.335496 [info ] [Thread-1 (]: 2 of 12 PASS assert_positive_views ............................................. [[32mPASS[0m in 0.25s]
[0m01:54:37.341081 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.assert_positive_views
[0m01:54:37.344728 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m01:54:37.348805 [info ] [Thread-1 (]: 3 of 12 START test not_null_dim_channels_channel_key ........................... [RUN]
[0m01:54:37.353679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.assert_positive_views, now test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0)
[0m01:54:37.357170 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m01:54:37.390346 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0"
[0m01:54:37.421980 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m01:54:37.431537 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0"
[0m01:54:37.465403 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0"
[0m01:54:37.469794 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0: BEGIN
[0m01:54:37.474293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:37.714094 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:54:37.716506 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0"
[0m01:54:37.719185 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select channel_key
from "medical_db"."raw"."dim_channels"
where channel_key is null



      
    ) dbt_internal_test
[0m01:54:37.726433 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:54:37.731033 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0: ROLLBACK
[0m01:54:37.735300 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0: Close
[0m01:54:37.739506 [info ] [Thread-1 (]: 3 of 12 PASS not_null_dim_channels_channel_key ................................. [[32mPASS[0m in 0.39s]
[0m01:54:37.743527 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m01:54:37.747024 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m01:54:37.750177 [info ] [Thread-1 (]: 4 of 12 START test not_null_dim_channels_channel_name .......................... [RUN]
[0m01:54:37.754524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0, now test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b)
[0m01:54:37.757734 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m01:54:37.771902 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m01:54:37.801602 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m01:54:37.899213 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m01:54:37.932930 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m01:54:37.936433 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b: BEGIN
[0m01:54:37.939359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:38.074402 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:54:38.079525 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m01:54:38.085269 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select channel_name
from "medical_db"."raw"."dim_channels"
where channel_name is null



      
    ) dbt_internal_test
[0m01:54:38.102166 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:54:38.112661 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b: ROLLBACK
[0m01:54:38.122482 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b: Close
[0m01:54:38.130432 [info ] [Thread-1 (]: 4 of 12 PASS not_null_dim_channels_channel_name ................................ [[32mPASS[0m in 0.37s]
[0m01:54:38.140202 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m01:54:38.147064 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8
[0m01:54:38.154298 [info ] [Thread-1 (]: 5 of 12 START test not_null_fct_messages_channel_key ........................... [RUN]
[0m01:54:38.160874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b, now test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8)
[0m01:54:38.166995 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8
[0m01:54:38.188578 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8"
[0m01:54:38.246301 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8
[0m01:54:38.260552 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8"
[0m01:54:38.318993 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8"
[0m01:54:38.324350 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8: BEGIN
[0m01:54:38.329439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:38.544826 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:54:38.550640 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8"
[0m01:54:38.556282 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select channel_key
from "medical_db"."raw"."fct_messages"
where channel_key is null



      
    ) dbt_internal_test
[0m01:54:38.572937 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:54:38.583859 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8: ROLLBACK
[0m01:54:38.593982 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8: Close
[0m01:54:38.602082 [info ] [Thread-1 (]: 5 of 12 PASS not_null_fct_messages_channel_key ................................. [[32mPASS[0m in 0.44s]
[0m01:54:38.610619 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8
[0m01:54:38.617454 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m01:54:38.623674 [info ] [Thread-1 (]: 6 of 12 START test not_null_fct_messages_message_id ............................ [RUN]
[0m01:54:38.629873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8, now test.medical_warehouse.not_null_fct_messages_message_id.de346706b5)
[0m01:54:38.635954 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m01:54:38.658189 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5"
[0m01:54:38.716102 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m01:54:38.738099 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5"
[0m01:54:38.795708 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5"
[0m01:54:38.801319 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_fct_messages_message_id.de346706b5: BEGIN
[0m01:54:38.806900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:39.024073 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:54:39.030080 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5"
[0m01:54:39.035602 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_fct_messages_message_id.de346706b5: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select message_id
from "medical_db"."raw"."fct_messages"
where message_id is null



      
    ) dbt_internal_test
[0m01:54:39.051542 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:54:39.060970 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_fct_messages_message_id.de346706b5: ROLLBACK
[0m01:54:39.071594 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_fct_messages_message_id.de346706b5: Close
[0m01:54:39.078672 [info ] [Thread-1 (]: 6 of 12 PASS not_null_fct_messages_message_id .................................. [[32mPASS[0m in 0.45s]
[0m01:54:39.088213 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m01:54:39.094609 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m01:54:39.101181 [info ] [Thread-1 (]: 7 of 12 START test not_null_stg_telegram_messages_channel_name ................. [RUN]
[0m01:54:39.108140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_fct_messages_message_id.de346706b5, now test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8)
[0m01:54:39.113636 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m01:54:39.137777 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m01:54:39.194208 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m01:54:39.209094 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m01:54:39.266998 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m01:54:39.272935 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: BEGIN
[0m01:54:39.278556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:39.495291 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:54:39.501219 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m01:54:39.506981 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select channel_name
from "medical_db"."raw"."stg_telegram_messages"
where channel_name is null



      
    ) dbt_internal_test
[0m01:54:39.527484 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:54:39.537898 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: ROLLBACK
[0m01:54:39.546572 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: Close
[0m01:54:39.554186 [info ] [Thread-1 (]: 7 of 12 PASS not_null_stg_telegram_messages_channel_name ....................... [[32mPASS[0m in 0.45s]
[0m01:54:39.562204 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m01:54:39.569069 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m01:54:39.574472 [info ] [Thread-1 (]: 8 of 12 START test not_null_stg_telegram_messages_message_date ................. [RUN]
[0m01:54:39.580863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8, now test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14)
[0m01:54:39.586844 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m01:54:39.613465 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m01:54:39.671296 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m01:54:39.688162 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m01:54:39.745658 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m01:54:39.752268 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14: BEGIN
[0m01:54:39.758398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:39.972852 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:54:39.978357 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m01:54:39.984024 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select message_date
from "medical_db"."raw"."stg_telegram_messages"
where message_date is null



      
    ) dbt_internal_test
[0m01:54:40.004401 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:54:40.014068 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14: ROLLBACK
[0m01:54:40.024215 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14: Close
[0m01:54:40.031742 [info ] [Thread-1 (]: 8 of 12 PASS not_null_stg_telegram_messages_message_date ....................... [[32mPASS[0m in 0.45s]
[0m01:54:40.040642 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m01:54:40.047127 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m01:54:40.053883 [info ] [Thread-1 (]: 9 of 12 START test not_null_stg_telegram_messages_message_id ................... [RUN]
[0m01:54:40.093830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14, now test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6)
[0m01:54:40.099101 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m01:54:40.129848 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m01:54:40.186631 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m01:54:40.201687 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m01:54:40.258096 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m01:54:40.263684 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6: BEGIN
[0m01:54:40.269202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:40.562725 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:54:40.581916 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m01:54:40.601823 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select message_id
from "medical_db"."raw"."stg_telegram_messages"
where message_id is null



      
    ) dbt_internal_test
[0m01:54:40.619209 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:54:40.624977 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6: ROLLBACK
[0m01:54:40.630288 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6: Close
[0m01:54:40.635592 [info ] [Thread-1 (]: 9 of 12 PASS not_null_stg_telegram_messages_message_id ......................... [[32mPASS[0m in 0.54s]
[0m01:54:40.639611 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m01:54:40.657810 [debug] [Thread-1 (]: Began running node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m01:54:40.663794 [info ] [Thread-1 (]: 10 of 12 START test relationships_fct_messages_channel_key__channel_key__ref_dim_channels_  [RUN]
[0m01:54:40.671156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6, now test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a)
[0m01:54:40.675252 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m01:54:40.696362 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a"
[0m01:54:40.716757 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m01:54:40.723488 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a"
[0m01:54:40.746314 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a"
[0m01:54:40.750021 [debug] [Thread-1 (]: On test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a: BEGIN
[0m01:54:40.753268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:40.878226 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:54:40.881372 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a"
[0m01:54:40.885258 [debug] [Thread-1 (]: On test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select channel_key as from_field
    from "medical_db"."raw"."fct_messages"
    where channel_key is not null
),

parent as (
    select channel_key as to_field
    from "medical_db"."raw"."dim_channels"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:54:40.896181 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:54:40.902320 [debug] [Thread-1 (]: On test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a: ROLLBACK
[0m01:54:40.907928 [debug] [Thread-1 (]: On test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a: Close
[0m01:54:40.911777 [info ] [Thread-1 (]: 10 of 12 PASS relationships_fct_messages_channel_key__channel_key__ref_dim_channels_  [[32mPASS[0m in 0.24s]
[0m01:54:40.917415 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m01:54:40.921049 [debug] [Thread-1 (]: Began running node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m01:54:40.924528 [info ] [Thread-1 (]: 11 of 12 START test unique_dim_channels_channel_key ............................ [RUN]
[0m01:54:40.928138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a, now test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56)
[0m01:54:40.931346 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m01:54:40.949960 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56"
[0m01:54:40.983801 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m01:54:40.991991 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56"
[0m01:54:41.034531 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56"
[0m01:54:41.039677 [debug] [Thread-1 (]: On test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56: BEGIN
[0m01:54:41.044478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:41.258683 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:54:41.265746 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56"
[0m01:54:41.271656 [debug] [Thread-1 (]: On test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    channel_key as unique_field,
    count(*) as n_records

from "medical_db"."raw"."dim_channels"
where channel_key is not null
group by channel_key
having count(*) > 1



      
    ) dbt_internal_test
[0m01:54:41.288709 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:54:41.299885 [debug] [Thread-1 (]: On test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56: ROLLBACK
[0m01:54:41.308432 [debug] [Thread-1 (]: On test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56: Close
[0m01:54:41.316020 [info ] [Thread-1 (]: 11 of 12 PASS unique_dim_channels_channel_key .................................. [[32mPASS[0m in 0.39s]
[0m01:54:41.324189 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m01:54:41.332041 [debug] [Thread-1 (]: Began running node test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8
[0m01:54:41.339102 [info ] [Thread-1 (]: 12 of 12 START test unique_dim_channels_channel_name ........................... [RUN]
[0m01:54:41.345174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56, now test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8)
[0m01:54:41.351924 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8
[0m01:54:41.375333 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8"
[0m01:54:41.432657 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8
[0m01:54:41.471407 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8"
[0m01:54:41.527557 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8"
[0m01:54:41.532922 [debug] [Thread-1 (]: On test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8: BEGIN
[0m01:54:41.538643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:41.752221 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:54:41.757983 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8"
[0m01:54:41.763906 [debug] [Thread-1 (]: On test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    channel_name as unique_field,
    count(*) as n_records

from "medical_db"."raw"."dim_channels"
where channel_name is not null
group by channel_name
having count(*) > 1



      
    ) dbt_internal_test
[0m01:54:41.781343 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:54:41.791818 [debug] [Thread-1 (]: On test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8: ROLLBACK
[0m01:54:41.801811 [debug] [Thread-1 (]: On test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8: Close
[0m01:54:41.807970 [info ] [Thread-1 (]: 12 of 12 PASS unique_dim_channels_channel_name ................................. [[32mPASS[0m in 0.46s]
[0m01:54:41.816766 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8
[0m01:54:41.828653 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:41.834257 [debug] [MainThread]: On master: BEGIN
[0m01:54:41.838787 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:54:42.003975 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:54:42.006665 [debug] [MainThread]: On master: COMMIT
[0m01:54:42.009101 [debug] [MainThread]: Using postgres connection "master"
[0m01:54:42.011787 [debug] [MainThread]: On master: COMMIT
[0m01:54:42.016912 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:54:42.019697 [debug] [MainThread]: On master: Close
[0m01:54:42.022764 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:54:42.025705 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8' was properly closed.
[0m01:54:42.028444 [info ] [MainThread]: 
[0m01:54:42.031526 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 5.84 seconds (5.84s).
[0m01:54:42.038820 [debug] [MainThread]: Command end result
[0m01:54:42.298836 [info ] [MainThread]: 
[0m01:54:42.306121 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:54:42.311520 [info ] [MainThread]: 
[0m01:54:42.319792 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m01:54:42.328933 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 13.709055, "process_user_time": 6.593494, "process_kernel_time": 0.982528, "process_mem_max_rss": "117156", "process_out_blocks": "1272", "process_in_blocks": "0"}
[0m01:54:42.335640 [debug] [MainThread]: Command `dbt test` succeeded at 01:54:42.335076 after 13.72 seconds
[0m01:54:42.340729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762f2bf59fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762f2be38450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762f2fce90d0>]}
[0m01:54:42.346820 [debug] [MainThread]: Flushing usage events
[0m01:54:59.922519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d764639a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d76464d8810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d764530a110>]}


============================== 01:54:59.944321 | 1c6d6802-a48e-4634-ae15-20bdf89a7c3b ==============================
[0m01:54:59.944321 [info ] [MainThread]: Running with dbt=1.8.3
[0m01:54:59.950171 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:55:00.543498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c6d6802-a48e-4634-ae15-20bdf89a7c3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d76438248d0>]}
[0m01:55:00.695247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c6d6802-a48e-4634-ae15-20bdf89a7c3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7646d21ad0>]}
[0m01:55:00.699648 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:55:00.804280 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m01:55:06.266230 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:55:06.268375 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:55:06.395140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c6d6802-a48e-4634-ae15-20bdf89a7c3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7643626310>]}
[0m01:55:06.455086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c6d6802-a48e-4634-ae15-20bdf89a7c3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d76436fd490>]}
[0m01:55:06.458698 [info ] [MainThread]: Found 4 models, 12 data tests, 1 source, 529 macros
[0m01:55:06.462167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c6d6802-a48e-4634-ae15-20bdf89a7c3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7643735dd0>]}
[0m01:55:06.475075 [info ] [MainThread]: 
[0m01:55:06.479712 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:55:06.496060 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_db_raw'
[0m01:55:06.653822 [debug] [ThreadPool]: Using postgres connection "list_medical_db_raw"
[0m01:55:06.659379 [debug] [ThreadPool]: On list_medical_db_raw: BEGIN
[0m01:55:06.662608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:55:06.888495 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:55:06.890996 [debug] [ThreadPool]: Using postgres connection "list_medical_db_raw"
[0m01:55:06.893460 [debug] [ThreadPool]: On list_medical_db_raw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_db_raw"} */
select
      'medical_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'medical_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'medical_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m01:55:06.914466 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m01:55:06.919405 [debug] [ThreadPool]: On list_medical_db_raw: ROLLBACK
[0m01:55:06.924504 [debug] [ThreadPool]: On list_medical_db_raw: Close
[0m01:55:06.940825 [debug] [MainThread]: Using postgres connection "master"
[0m01:55:06.943431 [debug] [MainThread]: On master: BEGIN
[0m01:55:06.946010 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:55:07.055394 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:55:07.058122 [debug] [MainThread]: Using postgres connection "master"
[0m01:55:07.060600 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:55:07.087653 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m01:55:07.092879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c6d6802-a48e-4634-ae15-20bdf89a7c3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7643755bd0>]}
[0m01:55:07.095403 [debug] [MainThread]: On master: ROLLBACK
[0m01:55:07.100062 [debug] [MainThread]: On master: Close
[0m01:55:07.103185 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:55:07.106657 [info ] [MainThread]: 
[0m01:55:07.133178 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_dates
[0m01:55:07.137122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medical_db_raw, now model.medical_warehouse.dim_dates)
[0m01:55:07.140230 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_dates
[0m01:55:07.221135 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m01:55:07.224163 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: BEGIN
[0m01:55:07.226797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:55:07.335650 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:55:07.339190 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m01:55:07.341824 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */


        select 
        ((cast('2026-01-01' as date))::date - (cast('2024-01-01' as date))::date)
    
[0m01:55:07.347528 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:55:07.378388 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_dates"
[0m01:55:07.403735 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_dates
[0m01:55:07.406337 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: ROLLBACK
[0m01:55:07.410760 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: Close
[0m01:55:07.414257 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_dates
[0m01:55:07.417189 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m01:55:07.420755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_dates, now model.medical_warehouse.stg_telegram_messages)
[0m01:55:07.423549 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m01:55:07.432210 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m01:55:07.457567 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m01:55:07.461545 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m01:55:07.466532 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_channels
[0m01:55:07.470149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.stg_telegram_messages, now model.medical_warehouse.dim_channels)
[0m01:55:07.473585 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_channels
[0m01:55:07.517511 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m01:55:07.547435 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_channels
[0m01:55:07.551488 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_channels
[0m01:55:07.555341 [debug] [Thread-1 (]: Began running node test.medical_warehouse.assert_no_future_messages
[0m01:55:07.559072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_channels, now test.medical_warehouse.assert_no_future_messages)
[0m01:55:07.562131 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.assert_no_future_messages
[0m01:55:07.572345 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.assert_no_future_messages"
[0m01:55:07.598304 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.assert_no_future_messages
[0m01:55:07.602498 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.assert_no_future_messages
[0m01:55:07.606054 [debug] [Thread-1 (]: Began running node test.medical_warehouse.assert_positive_views
[0m01:55:07.609248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.assert_no_future_messages, now test.medical_warehouse.assert_positive_views)
[0m01:55:07.612231 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.assert_positive_views
[0m01:55:07.626424 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.assert_positive_views"
[0m01:55:07.653825 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.assert_positive_views
[0m01:55:07.658018 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.assert_positive_views
[0m01:55:07.661459 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m01:55:07.664535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.assert_positive_views, now test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8)
[0m01:55:07.667413 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m01:55:07.698685 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m01:55:07.732526 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m01:55:07.737433 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m01:55:07.741011 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m01:55:07.744269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8, now test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14)
[0m01:55:07.747337 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m01:55:07.761599 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m01:55:07.795364 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m01:55:07.799520 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m01:55:07.803327 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m01:55:07.807061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14, now test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6)
[0m01:55:07.810137 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m01:55:07.823868 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m01:55:07.856156 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m01:55:07.860217 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m01:55:07.863763 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_messages
[0m01:55:07.867243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6, now model.medical_warehouse.fct_messages)
[0m01:55:07.870454 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fct_messages
[0m01:55:07.880670 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fct_messages"
[0m01:55:07.910044 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fct_messages
[0m01:55:07.913769 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_messages
[0m01:55:07.916791 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m01:55:07.920641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.fct_messages, now test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0)
[0m01:55:07.923976 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m01:55:07.937138 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0"
[0m01:55:07.969202 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m01:55:07.973960 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m01:55:07.977371 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m01:55:07.980329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0, now test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b)
[0m01:55:07.983118 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m01:55:07.996222 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m01:55:08.028008 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m01:55:08.031863 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m01:55:08.034947 [debug] [Thread-1 (]: Began running node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m01:55:08.038768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b, now test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56)
[0m01:55:08.042053 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m01:55:08.061523 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56"
[0m01:55:08.094649 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m01:55:08.098566 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m01:55:08.101832 [debug] [Thread-1 (]: Began running node test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8
[0m01:55:08.105988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56, now test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8)
[0m01:55:08.109132 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8
[0m01:55:08.122470 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8"
[0m01:55:08.156375 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8
[0m01:55:08.163576 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8
[0m01:55:08.168323 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8
[0m01:55:08.172467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.unique_dim_channels_channel_name.e57614abc8, now test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8)
[0m01:55:08.175866 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8
[0m01:55:08.191417 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8"
[0m01:55:08.225299 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8
[0m01:55:08.229412 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8
[0m01:55:08.232477 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m01:55:08.236014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_fct_messages_channel_key.3a5513b8b8, now test.medical_warehouse.not_null_fct_messages_message_id.de346706b5)
[0m01:55:08.239414 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m01:55:08.256950 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5"
[0m01:55:08.290423 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m01:55:08.294322 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m01:55:08.297191 [debug] [Thread-1 (]: Began running node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m01:55:08.300438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_fct_messages_message_id.de346706b5, now test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a)
[0m01:55:08.304213 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m01:55:08.327715 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a"
[0m01:55:08.359710 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m01:55:08.364169 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m01:55:08.370907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:55:08.373875 [debug] [MainThread]: Connection 'test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a' was properly closed.
[0m01:55:08.382998 [debug] [MainThread]: Command end result
[0m01:55:09.084953 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m01:55:09.090647 [info ] [MainThread]: Building catalog
[0m01:55:09.139408 [debug] [ThreadPool]: Acquiring new postgres connection 'medical_db.information_schema'
[0m01:55:09.187063 [debug] [ThreadPool]: Using postgres connection "medical_db.information_schema"
[0m01:55:09.193089 [debug] [ThreadPool]: On medical_db.information_schema: BEGIN
[0m01:55:09.197796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:55:09.399219 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:55:09.407482 [debug] [ThreadPool]: Using postgres connection "medical_db.information_schema"
[0m01:55:09.411145 [debug] [ThreadPool]: On medical_db.information_schema: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "medical_db.information_schema"} */

    
    

    select
        'medical_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('telegram_messages')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('fct_messages')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('stg_telegram_messages')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('dim_channels')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('dim_dates')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m01:55:09.444745 [debug] [ThreadPool]: SQL status: SELECT 44 in 0.0 seconds
[0m01:55:09.460562 [debug] [ThreadPool]: On medical_db.information_schema: ROLLBACK
[0m01:55:09.465023 [debug] [ThreadPool]: On medical_db.information_schema: Close
[0m01:55:09.718619 [info ] [MainThread]: Catalog written to /usr/app/dbt/target/catalog.json
[0m01:55:09.723563 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 10.0491705, "process_user_time": 6.287223, "process_kernel_time": 1.146776, "process_mem_max_rss": "113456", "process_out_blocks": "1272", "process_in_blocks": "0"}
[0m01:55:09.727537 [debug] [MainThread]: Command `dbt docs generate` succeeded at 01:55:09.727086 after 10.05 seconds
[0m01:55:09.731049 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m01:55:09.733897 [debug] [MainThread]: Connection 'medical_db.information_schema' was properly closed.
[0m01:55:09.737622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7643633650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7649090cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7649090b90>]}
[0m01:55:09.740683 [debug] [MainThread]: Flushing usage events
